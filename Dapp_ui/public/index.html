<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
      <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>DApp</title>
  </head>
  <body>
    
    
<div class="container mt-3">
  <h2>Token  ERC20 Demo </h2>
           
  <table class="table table-hover table-bordered">
  
    <tbody>
      <tr>
       <td>Token </td>
       <td>address </td>
       <td>Total supply</td>
     </tr>
     <tr>
       <td id="symbol_val">symbol </td>
       <td id="address_val">address value</td>
       <td id="total_supply_val">Total supply value</td>
     </tr>
    
  </table>
  
</div>
<!--message div-->
<div class="container mt-5"><b>
<div  id="message_display"  >
</div></b>
</div>
<!-- another panel-->
<div class="container mt-4">
<div class="accordion" id="accordionExample">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingOne">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
        Request
      </button>
    </h2>
    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <strong>request tokens in your account.</strong> 
     
<div class="input-group mb-3">
    <input type="text" id="address_1" class="form-control" placeholder="Address" aria-label="address" aria-describedby="basic-addon1">
</div>

<div class="input-group mb-3">
    <input type="text"  id="amount_1"  class="form-control" placeholder="Amount" aria-label="amount" aria-describedby="basic-addon1">
</div>
<button type="button" id="requestTokens_Bt" class="btn btn-info">Get</button>

	 </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingTwo">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
        View Balance
      </button>
    </h2>
    <div id="collapseTwo"  class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <strong>Check tokens balance in your account.</strong>
		
		<div class="input-group mb-3">
    <input type="text" id="address_2" class="form-control" placeholder="Address" aria-label="address" aria-describedby="basic-addon1">
       </div>
		
		<button type="button" id="viewBalance_Bt"  class="btn btn-info">view</button>
		
		</div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingThree">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
       Send 
      </button>
    </h2>
    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <strong>Send tokens to  Friend.</strong> please enter the address of your friend
		
		<div class="input-group mb-3">
    <input type="text" id="account_from" class="form-control" placeholder="Address" aria-label="from" aria-describedby="basic-addon1">
       </div>
	   
		<div class="input-group mb-3">
    <input type="text" id="account_to"  class="form-control" placeholder="Address" aria-label="to" aria-describedby="basic-addon1">
       </div>

       <div class="input-group mb-3">
        <input type="text" id="amount_3"  class="form-control" placeholder="Address" aria-label="to" aria-describedby="basic-addon1">
           </div>
		
		<button type="button" id="sendToFriend_Bt"  class="btn btn-info">send</button>
		
		
      </div>
    </div>
  </div>
  
    <div class="accordion-item">
    <h2 class="accordion-header" id="headingFour">
      <button class="accordion-button collapsed"   type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
       Deposit  
      </button>
    </h2>
    <div id="collapseFour"   class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <strong>Add more tokens  supply.</strong> 
		
		
			<div class="input-group mb-3">
        <input type="number" id="amount_4" class="form-control" placeholder="Amount" aria-label="amount" aria-describedby="basic-addon1">
       </div>
		
		<button type="button"  id="increaseSupply_Bt" class="btn btn-info">Mint</button>
		
      </div>
    </div>
  </div>
  
  
   <div class="accordion-item">
    <h2 class="accordion-header" id="headingFive">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
       Buy me a coffee  
      </button>
    </h2>
    <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <strong>You can send some ethers to owner.</strong> 
		
		
			<div class="input-group mb-3">
        <input type="text" id="amount_5" class="form-control" placeholder="ethers" aria-label="ethers" aria-describedby="basic-addon1">
       </div>
		
		<button type="button" id="buyMeCoffe_Bt" class="btn btn-info">Buy</button>
		
      </div>
    </div>
  </div>
</div>

</div>

    
  </body>
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js"  crossorigin="anonymous"></script>
  
  <script src="https://code.jquery.com/jquery-3.3.1.slim.js"  crossorigin="anonymous"></script>
 
  <script>

   var Mycontract;
  var balanceOf;
   $(document).ready(function()
   {
   
   let web3= new Web3(new Web3.providers.HttpProvider("HTTP://127.0.0.1:7545"));
  //  web3= new Web3(web3.currentProvider);
     //SC address
    var address="0x4351c63faa1BB189f3AAedB2B43D3382D702a8bF";
  
    var ABI=[
{
"inputs": [
  {
    "internalType": "string",
    "name": "_name",
    "type": "string"
  },
  {
    "internalType": "string",
    "name": "_symbol",
    "type": "string"
  },
  {
    "internalType": "string",
    "name": "_decimal",
    "type": "string"
  },
  {
    "internalType": "uint256",
    "name": "_supply",
    "type": "uint256"
  }
],
"stateMutability": "nonpayable",
"type": "constructor"
},
{
"anonymous": false,
"inputs": [
  {
    "indexed": true,
    "internalType": "address",
    "name": "_owner",
    "type": "address"
  },
  {
    "indexed": true,
    "internalType": "address",
    "name": "_spender",
    "type": "address"
  },
  {
    "indexed": false,
    "internalType": "uint256",
    "name": "_value",
    "type": "uint256"
  }
],
"name": "Approval",
"type": "event"
},
{
"inputs": [
  {
    "internalType": "address",
    "name": "_spender",
    "type": "address"
  },
  {
    "internalType": "uint256",
    "name": "_value",
    "type": "uint256"
  }
],
"name": "approve",
"outputs": [
  {
    "internalType": "bool",
    "name": "success",
    "type": "bool"
  }
],
"stateMutability": "nonpayable",
"type": "function"
},
{
"inputs": [
  {
    "internalType": "uint256",
    "name": "_tokens",
    "type": "uint256"
  }
],
"name": "mint",
"outputs": [
  {
    "internalType": "uint256",
    "name": "",
    "type": "uint256"
  }
],
"stateMutability": "nonpayable",
"type": "function"
},
{
"inputs": [
  {
    "internalType": "address",
    "name": "_to",
    "type": "address"
  },
  {
    "internalType": "uint256",
    "name": "_value",
    "type": "uint256"
  }
],
"name": "transfer",
"outputs": [
  {
    "internalType": "bool",
    "name": "",
    "type": "bool"
  }
],
"stateMutability": "nonpayable",
"type": "function"
},
{
"anonymous": false,
"inputs": [
  {
    "indexed": true,
    "internalType": "address",
    "name": "_from",
    "type": "address"
  },
  {
    "indexed": true,
    "internalType": "address",
    "name": "_to",
    "type": "address"
  },
  {
    "indexed": false,
    "internalType": "uint256",
    "name": "_value",
    "type": "uint256"
  }
],
"name": "Transfer",
"type": "event"
},
{
"inputs": [
  {
    "internalType": "address",
    "name": "_from",
    "type": "address"
  },
  {
    "internalType": "address",
    "name": "_to",
    "type": "address"
  },
  {
    "internalType": "uint256",
    "name": "_value",
    "type": "uint256"
  }
],
"name": "transferFrom",
"outputs": [
  {
    "internalType": "bool",
    "name": "",
    "type": "bool"
  }
],
"stateMutability": "nonpayable",
"type": "function"
},
{
"inputs": [
  {
    "internalType": "address",
    "name": "_owner",
    "type": "address"
  },
  {
    "internalType": "address",
    "name": "_spender",
    "type": "address"
  }
],
"name": "allowance",
"outputs": [
  {
    "internalType": "uint256",
    "name": "remaining",
    "type": "uint256"
  }
],
"stateMutability": "view",
"type": "function"
},
{
"inputs": [
  {
    "internalType": "address",
    "name": "_owner",
    "type": "address"
  }
],
"name": "balanceOf",
"outputs": [
  {
    "internalType": "uint256",
    "name": "",
    "type": "uint256"
  }
],
"stateMutability": "view",
"type": "function"
},
{
"inputs": [],
"name": "totalSupply",
"outputs": [
  {
    "internalType": "uint256",
    "name": "",
    "type": "uint256"
  }
],
"stateMutability": "view",
"type": "function"
}
];
     Mycontract = new web3.eth.Contract(ABI,address);
    
    var account=Mycontract.address;
     Mycontract.methods.totalSupply().call().then(function(value)
          {
                     
                $('#total_supply_val').html(value);
           
          })

          $('#address_val').html(address);
  
      
      
  
   })

   document.getElementById("requestTokens_Bt").addEventListener("click", getTokens);
   document.getElementById("viewBalance_Bt").addEventListener("click", getBalance);
  document.getElementById("sendToFriend_Bt").addEventListener("click", sendToFriend );
  document.getElementById("increaseSupply_Bt").addEventListener("click", increaseSupply);
  document.getElementById("buyMeCoffe_Bt").addEventListener("click", buyMeCoffe);


   function getBalance()
   {
    
    var address_= document.getElementById("addBalanceFor").value;
    if(address_==null || address_=="");
     {
      showMessage("please enter address");
     }
     Mycontract.methods.balanceOf(address_).call().then(function(bal)
          {
            
            clearMessage();
            showMessage("there are "+ bal +" tokens in  "+address_);
           
          })
   }

   function getTokens()
   {
    
    var address_= document.getElementById("address_1").value;
    var amount_= document.getElementById("amount_1").value;
    if(address_==null || address_=="");
     {
      showMessage("please enter address");
     }
     if(amount_==null || amount_=="");
     {
      showMessage("please enter number of tokens you want");
     }
     if(amount_>50);
     {
      showMessage("max limit is 50 tokens");
     }
     Mycontract.methods.transfer(address_,amount).send().then(function(error,ebal)
          {
            
            clearMessage();
            showMessage("there are "+ bal +" tokens in  "+address_);
           
          })
   }


   function sendToFriend()
   {
    var address_frm= document.getElementById("address_from").value;
    var address_to= document.getElementById("address_to").value;
    var amount_= document.getElementById("amount_3").value;
    
    Mycontract.methods.transferFrom(address_frm,address_to,amount_).call().then(function(ebal)
          {
            
            clearMessage();
            showMessage(amount_ + " tokens are transfered from "+address_frm+ " to  "+address_to);
           
          }).then(function(error)
          {
            showMessage(error);
          }).catch(function(error){
              showMessage(error);
          })



   }

   function showMessage(message_) {
  
    document.getElementById("message_display").innerText=message_;
   
  
    }
    function clearMessage() {
  
  document.getElementById("message_display").innerText="";
 

  }
 </script>
  </html>
